<nav title-text="全部消息"></nav>
<scroll-view
  class="message-list"
  scroll-y
  refresher-enabled
  refresher-triggered="{{ loading }}"
  bindrefresherrefresh="getMessageList"
>
  <view
    wx:for="{{ messageList }}"
    wx:key="index"
    class="session-item"
    bind:tap="toChat"
    bind:longpress="onSessionLongPress"
    data-user-id="{{ item.userId }}"
  >
    <view class="session-avatar">
      <image src="{{ item.avatar }}" mode="aspectFill" class="session-avatar-img" />
    </view>
    <view class="session-content">
      <view class="session-header">
        <view class="session-title">{{ item.name || '新对话' }}</view>
        <view class="session-meta">
          <view class="session-time">{{ item.formattedTime }}</view>
          <view
            class="session-delete"
            data-user-id="{{ item.userId }}"
            catchtap="onDeleteSessionTap"
          >
            ✕
          </view>
        </view>
      </view>
      <view class="session-preview">{{ item.lastMessage }}</view>
    </view>
  </view>
</scroll-view>

<view class="add-session-button" bind:tap="addSession">
  <view class="button-plus"></view>
</view>
